{"remainingRequest":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/babel-loader/lib/index.js!/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangyangzuo/Downloads/lucky-draw-master/src/components/Importphoto.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/src/components/Importphoto.vue","mtime":1617288854000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci5jb25zdHJ1Y3RvciI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy96aGFuZ3lhbmd6dW8vRG93bmxvYWRzL2x1Y2t5LWRyYXctbWFzdGVyL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgZGF0YWJhc2UsIERCX1NUT1JFX05BTUUgfSBmcm9tICdAL2hlbHBlci9kYic7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnSW1wb3J0cGhvdG8nLAogIHByb3BzOiB7CiAgICB2aXNpYmxlOiBCb29sZWFuCiAgfSwKICBjb21wdXRlZDogewogICAgY29uZmlnOiB7CiAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5jb25maWc7CiAgICAgIH0KICAgIH0KICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpZDogMCwKICAgICAgdmFsdWU6ICcnLAogICAgICBmaWxlbmFtZTogJ+eCueWHu+mAieaLqeeFp+eJhycKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbnB1dENoYW5nZTogZnVuY3Rpb24gaW5wdXRDaGFuZ2UoZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGZpbGVMaXN0ID0gZS50YXJnZXQuZmlsZXM7CiAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICBmb3JtRGF0YS5hcHBlbmQoJ3VwbG9hZEltZycsIGZpbGVMaXN0WzBdKTsKICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgIHZhciBBbGxvd0ltZ0ZpbGVTaXplID0gMTAyNCAqIDE1MDsKICAgICAgdmFyIGZpbGUgPSBmaWxlTGlzdFswXTsKCiAgICAgIGlmIChmaWxlKSB7CiAgICAgICAgdGhpcy5maWxlbmFtZSA9IGZpbGUubmFtZTsKICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmaWxlKTsKCiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChBbGxvd0ltZ0ZpbGVTaXplICE9IDAgJiYgQWxsb3dJbWdGaWxlU2l6ZSA8IHJlYWRlci5yZXN1bHQubGVuZ3RoKSB7CiAgICAgICAgICAgIHJldHVybiBfdGhpcy4kbWVzc2FnZS5lcnJvcign5LiN5YWB6K645LiK5Lyg5aSn5LqOMTUwS0LnmoTlm77niYcnKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF90aGlzLnZhbHVlID0gcmVhZGVyLnJlc3VsdDsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CiAgICB9LAogICAgc2F2ZUhhbmRsZXI6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9zYXZlSGFuZGxlciA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICAgIHZhciBpZCwgdmFsdWUsIElELCBEYXRhLCBwYXJhbTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBpZCA9IHRoaXMuaWQsIHZhbHVlID0gdGhpcy52YWx1ZTsKICAgICAgICAgICAgICAgIElEID0gTnVtYmVyKGlkKTsKCiAgICAgICAgICAgICAgICBpZiAoISghSUQgfHwgSUQgPD0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+WPt+eggeW/hemhu+Wkp+S6jjDnmoTmlbTmlbAnKSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdGhpcy4kbWVzc2FnZS5lcnJvcign6K+36YCJ5oup54Wn54mHJykpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgIHJldHVybiBkYXRhYmFzZS5nZXQoREJfU1RPUkVfTkFNRSwgSUQpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICBEYXRhID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIHBhcmFtID0gewogICAgICAgICAgICAgICAgICBpZDogSUQsCiAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGRhdGFiYXNlW0RhdGEgPyAnZWRpdCcgOiAnYWRkJ10oREJfU1RPUkVfTkFNRSwgRGF0YSA/IElEIDogcGFyYW0sIERhdGEgPyBwYXJhbSA6IG51bGwpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLiRyZWZzLnVwbG9hZGlucHV0LnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLmZpbGVuYW1lID0gJ+eCueWHu+mAieaLqeeFp+eJhyc7CgogICAgICAgICAgICAgICAgICAgIF90aGlzMi4kZW1pdCgndXBkYXRlOnZpc2libGUnLCBmYWxzZSk7CgogICAgICAgICAgICAgICAgICAgIF90aGlzMi4kZW1pdCgnZ2V0UGhvdG8nKTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfkv53lrZjmiJDlip8nLAogICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLiRtZXNzYWdlLmVycm9yKCfkv53lrZjlpLHotKUnKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAgICAgICBfdGhpczIuJG1lc3NhZ2UuZXJyb3IoZXJyLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gc2F2ZUhhbmRsZXIoKSB7CiAgICAgICAgcmV0dXJuIF9zYXZlSGFuZGxlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gc2F2ZUhhbmRsZXI7CiAgICB9KCkKICB9Cn07"},{"version":3,"sources":["Importphoto.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <el-dialog\n    :visible=\"visible\"\n    :append-to-body=\"true\"\n    width=\"300px\"\n    @close=\"$emit('update:visible', false)\"\n    class=\"c-Importphoto\"\n  >\n    <el-row>\n      <label for=\"idinput\">抽奖号码</label>\n      <el-input\n        id=\"idinput\"\n        size=\"mini\"\n        type=\"number\"\n        v-model=\"id\"\n        :min=\"0\"\n        :max=\"config.number\"\n      ></el-input>\n    </el-row>\n    <el-row>\n      <label for=\"idinput\">照片选择</label>\n      <span class=\"selectbg\" :data-tip=\"filename\">\n        <input\n          ref=\"uploadinput\"\n          class=\"upload\"\n          type=\"file\"\n          accept=\".jpg,.png\"\n          @change=\"inputChange\"\n        />\n      </span>\n    </el-row>\n    <el-row class=\"photo\">\n      <label>已选照片</label>\n      <img v-if=\"value\" :src=\"value\" alt=\"img\" :width=\"140\" :height=\"140\" />\n      <span v-else>暂未选择</span>\n    </el-row>\n    <el-row>\n      支持jpg和png，照片大小不能超过150kb,建议20-50kb，建议尺寸为160*160px\n    </el-row>\n    <el-row class=\"center\">\n      <el-button size=\"mini\" type=\"primary\" @click=\"saveHandler\"\n        >保存</el-button\n      >\n      <el-button size=\"mini\" @click=\"$emit('update:visible', false)\"\n        >取消</el-button\n      >\n    </el-row>\n  </el-dialog>\n</template>\n<script>\nimport { database, DB_STORE_NAME } from '@/helper/db';\n\nexport default {\n  name: 'Importphoto',\n  props: {\n    visible: Boolean\n  },\n  computed: {\n    config: {\n      get() {\n        return this.$store.state.config;\n      }\n    }\n  },\n  data() {\n    return {\n      id: 0,\n      value: '',\n      filename: '点击选择照片'\n    };\n  },\n  methods: {\n    inputChange(e) {\n      const fileList = e.target.files;\n      const formData = new FormData();\n      formData.append('uploadImg', fileList[0]);\n      const reader = new FileReader();\n      const AllowImgFileSize = 1024 * 150;\n      const file = fileList[0];\n      if (file) {\n        this.filename = file.name;\n        reader.readAsDataURL(file);\n        reader.onload = () => {\n          if (\n            AllowImgFileSize != 0 &&\n            AllowImgFileSize < reader.result.length\n          ) {\n            return this.$message.error('不允许上传大于150KB的图片');\n          } else {\n            this.value = reader.result;\n          }\n        };\n      }\n    },\n    async saveHandler() {\n      const { id, value } = this;\n      const ID = Number(id);\n      if (!ID || ID <= 0) {\n        return this.$message.error('号码必须大于0的整数');\n      }\n      if (!value) {\n        return this.$message.error('请选择照片');\n      }\n      const Data = await database.get(DB_STORE_NAME, ID);\n      const param = {\n        id: ID,\n        value\n      };\n      database[Data ? 'edit' : 'add'](\n        DB_STORE_NAME,\n        Data ? ID : param,\n        Data ? param : null\n      )\n        .then(res => {\n          if (res) {\n            this.$refs.uploadinput.value = '';\n            this.value = '';\n            this.filename = '点击选择照片';\n            this.$emit('update:visible', false);\n            this.$emit('getPhoto');\n            this.$message({\n              message: '保存成功',\n              type: 'success'\n            });\n          } else {\n            this.$message.error('保存失败');\n          }\n        })\n        .catch(err => {\n          this.$message.error(err.message);\n        });\n    }\n  }\n};\n</script>\n<style lang=\"scss\">\n.c-Importphoto {\n  .el-dialog {\n    height: 380px;\n  }\n  label {\n    margin-right: 20px;\n    vertical-align: top;\n  }\n  .el-input {\n    width: 140px;\n  }\n  .el-row {\n    padding: 5px 0;\n  }\n  .center {\n    text-align: center;\n  }\n  .selectbg {\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 2px;\n    width: 140px;\n    height: 28px;\n    position: relative;\n    box-sizing: border-box;\n    &::before {\n      content: attr(data-tip);\n      width: 100%;\n      height: 100%;\n      text-align: center;\n      position: absolute;\n      top: 0;\n      left: 0;\n      line-height: 28px;\n      cursor: pointer;\n      overflow: hidden;\n      font-size: 12px;\n    }\n    .upload {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      opacity: 0;\n      z-index: 10;\n      cursor: pointer;\n    }\n  }\n  .photo {\n    img {\n      border: 1px solid #ccc;\n    }\n    span {\n      display: inline-block;\n      border: 1px solid #ccc;\n      border-radius: 2px;\n      width: 140px;\n      height: 140px;\n      line-height: 140px;\n      text-align: center;\n      position: relative;\n      box-sizing: border-box;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/components"}]}