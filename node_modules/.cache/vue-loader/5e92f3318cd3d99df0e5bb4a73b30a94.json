{"remainingRequest":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!/Users/zhangyangzuo/Downloads/lucky-draw-master/src/components/Importphoto.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/src/components/Importphoto.vue","mtime":1617288854000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_css-loader@3.6.0@css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_sass-loader@10.2.0@sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5jLUltcG9ydHBob3RvIHsKICAuZWwtZGlhbG9nIHsKICAgIGhlaWdodDogMzgwcHg7CiAgfQogIGxhYmVsIHsKICAgIG1hcmdpbi1yaWdodDogMjBweDsKICAgIHZlcnRpY2FsLWFsaWduOiB0b3A7CiAgfQogIC5lbC1pbnB1dCB7CiAgICB3aWR0aDogMTQwcHg7CiAgfQogIC5lbC1yb3cgewogICAgcGFkZGluZzogNXB4IDA7CiAgfQogIC5jZW50ZXIgewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogIH0KICAuc2VsZWN0YmcgewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsKICAgIGJvcmRlci1yYWRpdXM6IDJweDsKICAgIHdpZHRoOiAxNDBweDsKICAgIGhlaWdodDogMjhweDsKICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAmOjpiZWZvcmUgewogICAgICBjb250ZW50OiBhdHRyKGRhdGEtdGlwKTsKICAgICAgd2lkdGg6IDEwMCU7CiAgICAgIGhlaWdodDogMTAwJTsKICAgICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgIHRvcDogMDsKICAgICAgbGVmdDogMDsKICAgICAgbGluZS1oZWlnaHQ6IDI4cHg7CiAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgfQogICAgLnVwbG9hZCB7CiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgdG9wOiAwOwogICAgICBsZWZ0OiAwOwogICAgICB3aWR0aDogMTAwJTsKICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICBvcGFjaXR5OiAwOwogICAgICB6LWluZGV4OiAxMDsKICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgfQogIH0KICAucGhvdG8gewogICAgaW1nIHsKICAgICAgYm9yZGVyOiAxcHggc29saWQgI2NjYzsKICAgIH0KICAgIHNwYW4gewogICAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7CiAgICAgIGJvcmRlci1yYWRpdXM6IDJweDsKICAgICAgd2lkdGg6IDE0MHB4OwogICAgICBoZWlnaHQ6IDE0MHB4OwogICAgICBsaW5lLWhlaWdodDogMTQwcHg7CiAgICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgfQogIH0KfQo="},{"version":3,"sources":["Importphoto.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Importphoto.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <el-dialog\n    :visible=\"visible\"\n    :append-to-body=\"true\"\n    width=\"300px\"\n    @close=\"$emit('update:visible', false)\"\n    class=\"c-Importphoto\"\n  >\n    <el-row>\n      <label for=\"idinput\">抽奖号码</label>\n      <el-input\n        id=\"idinput\"\n        size=\"mini\"\n        type=\"number\"\n        v-model=\"id\"\n        :min=\"0\"\n        :max=\"config.number\"\n      ></el-input>\n    </el-row>\n    <el-row>\n      <label for=\"idinput\">照片选择</label>\n      <span class=\"selectbg\" :data-tip=\"filename\">\n        <input\n          ref=\"uploadinput\"\n          class=\"upload\"\n          type=\"file\"\n          accept=\".jpg,.png\"\n          @change=\"inputChange\"\n        />\n      </span>\n    </el-row>\n    <el-row class=\"photo\">\n      <label>已选照片</label>\n      <img v-if=\"value\" :src=\"value\" alt=\"img\" :width=\"140\" :height=\"140\" />\n      <span v-else>暂未选择</span>\n    </el-row>\n    <el-row>\n      支持jpg和png，照片大小不能超过150kb,建议20-50kb，建议尺寸为160*160px\n    </el-row>\n    <el-row class=\"center\">\n      <el-button size=\"mini\" type=\"primary\" @click=\"saveHandler\"\n        >保存</el-button\n      >\n      <el-button size=\"mini\" @click=\"$emit('update:visible', false)\"\n        >取消</el-button\n      >\n    </el-row>\n  </el-dialog>\n</template>\n<script>\nimport { database, DB_STORE_NAME } from '@/helper/db';\n\nexport default {\n  name: 'Importphoto',\n  props: {\n    visible: Boolean\n  },\n  computed: {\n    config: {\n      get() {\n        return this.$store.state.config;\n      }\n    }\n  },\n  data() {\n    return {\n      id: 0,\n      value: '',\n      filename: '点击选择照片'\n    };\n  },\n  methods: {\n    inputChange(e) {\n      const fileList = e.target.files;\n      const formData = new FormData();\n      formData.append('uploadImg', fileList[0]);\n      const reader = new FileReader();\n      const AllowImgFileSize = 1024 * 150;\n      const file = fileList[0];\n      if (file) {\n        this.filename = file.name;\n        reader.readAsDataURL(file);\n        reader.onload = () => {\n          if (\n            AllowImgFileSize != 0 &&\n            AllowImgFileSize < reader.result.length\n          ) {\n            return this.$message.error('不允许上传大于150KB的图片');\n          } else {\n            this.value = reader.result;\n          }\n        };\n      }\n    },\n    async saveHandler() {\n      const { id, value } = this;\n      const ID = Number(id);\n      if (!ID || ID <= 0) {\n        return this.$message.error('号码必须大于0的整数');\n      }\n      if (!value) {\n        return this.$message.error('请选择照片');\n      }\n      const Data = await database.get(DB_STORE_NAME, ID);\n      const param = {\n        id: ID,\n        value\n      };\n      database[Data ? 'edit' : 'add'](\n        DB_STORE_NAME,\n        Data ? ID : param,\n        Data ? param : null\n      )\n        .then(res => {\n          if (res) {\n            this.$refs.uploadinput.value = '';\n            this.value = '';\n            this.filename = '点击选择照片';\n            this.$emit('update:visible', false);\n            this.$emit('getPhoto');\n            this.$message({\n              message: '保存成功',\n              type: 'success'\n            });\n          } else {\n            this.$message.error('保存失败');\n          }\n        })\n        .catch(err => {\n          this.$message.error(err.message);\n        });\n    }\n  }\n};\n</script>\n<style lang=\"scss\">\n.c-Importphoto {\n  .el-dialog {\n    height: 380px;\n  }\n  label {\n    margin-right: 20px;\n    vertical-align: top;\n  }\n  .el-input {\n    width: 140px;\n  }\n  .el-row {\n    padding: 5px 0;\n  }\n  .center {\n    text-align: center;\n  }\n  .selectbg {\n    display: inline-block;\n    border: 1px solid #ccc;\n    border-radius: 2px;\n    width: 140px;\n    height: 28px;\n    position: relative;\n    box-sizing: border-box;\n    &::before {\n      content: attr(data-tip);\n      width: 100%;\n      height: 100%;\n      text-align: center;\n      position: absolute;\n      top: 0;\n      left: 0;\n      line-height: 28px;\n      cursor: pointer;\n      overflow: hidden;\n      font-size: 12px;\n    }\n    .upload {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      opacity: 0;\n      z-index: 10;\n      cursor: pointer;\n    }\n  }\n  .photo {\n    img {\n      border: 1px solid #ccc;\n    }\n    span {\n      display: inline-block;\n      border: 1px solid #ccc;\n      border-radius: 2px;\n      width: 140px;\n      height: 140px;\n      line-height: 140px;\n      text-align: center;\n      position: relative;\n      box-sizing: border-box;\n    }\n  }\n}\n</style>\n"]}]}