{"remainingRequest":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!/Users/zhangyangzuo/Downloads/lucky-draw-master/src/components/Tool.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/src/components/Tool.vue","mtime":1617288854000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_babel-loader@8.2.3@babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zhangyangzuo/Downloads/lucky-draw-master/node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7CiAgY2xlYXJEYXRhLAogIHJlbW92ZURhdGEsCiAgY29uZmlnRmllbGQsCiAgbGlzdEZpZWxkLAogIHJlc3VsdEZpZWxkLAogIGNvbnZlcnNpb25DYXRlZ29yeU5hbWUKfSBmcm9tICdAL2hlbHBlci9pbmRleCc7CmltcG9ydCBJbXBvcnRwaG90byBmcm9tICcuL0ltcG9ydHBob3RvJzsKaW1wb3J0IHsgZGF0YWJhc2UsIERCX1NUT1JFX05BTUUgfSBmcm9tICdAL2hlbHBlci9kYic7CgpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIHJ1bm5pbmc6IEJvb2xlYW4sCiAgICBjbG9zZVJlczogRnVuY3Rpb24KICB9LAogIGNvbXB1dGVkOiB7CiAgICBjb25maWc6IHsKICAgICAgZ2V0KCkgewogICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5jb25maWc7CiAgICAgIH0KICAgIH0sCiAgICByZW1haW4oKSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgdGhpcy5jb25maWdbdGhpcy5mb3JtLmNhdGVnb3J5XSAtCiAgICAgICAgKHRoaXMucmVzdWx0W3RoaXMuZm9ybS5jYXRlZ29yeV0KICAgICAgICAgID8gdGhpcy5yZXN1bHRbdGhpcy5mb3JtLmNhdGVnb3J5XS5sZW5ndGgKICAgICAgICAgIDogMCkKICAgICAgKTsKICAgIH0sCiAgICByZXN1bHQoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5yZXN1bHQ7CiAgICB9LAogICAgY2F0ZWdvcnlzKCkgewogICAgICBjb25zdCBvcHRpb25zID0gW107CiAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMuY29uZmlnKSB7CiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmhhc093blByb3BlcnR5KGtleSkpIHsKICAgICAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmNvbmZpZ1trZXldOwogICAgICAgICAgaWYgKGl0ZW0gPiAwKSB7CiAgICAgICAgICAgIGxldCBuYW1lID0gY29udmVyc2lvbkNhdGVnb3J5TmFtZShrZXkpOwogICAgICAgICAgICBuYW1lICYmCiAgICAgICAgICAgICAgb3B0aW9ucy5wdXNoKHsKICAgICAgICAgICAgICAgIGxhYmVsOiBuYW1lLAogICAgICAgICAgICAgICAgdmFsdWU6IGtleQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gb3B0aW9uczsKICAgIH0KICB9LAogIGNvbXBvbmVudHM6IHsgSW1wb3J0cGhvdG8gfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgc2hvd1NldHdhdDogZmFsc2UsCiAgICAgIHNob3dJbXBvcnQ6IGZhbHNlLAogICAgICBzaG93SW1wb3J0cGhvdG86IGZhbHNlLAogICAgICBzaG93UmVtb3Zlb3B0aW9uczogZmFsc2UsCiAgICAgIHJlbW92ZUluZm86IHsgdHlwZTogMCB9LAogICAgICBmb3JtOiB7CiAgICAgICAgY2F0ZWdvcnk6ICcnLAogICAgICAgIG1vZGU6IDEsCiAgICAgICAgcXR5OiAxLAogICAgICAgIGFsbGluOiBmYWxzZQogICAgICB9LAogICAgICBsaXN0U3RyOiAnJwogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICBzaG93UmVtb3Zlb3B0aW9ucyh2KSB7CiAgICAgIGlmICghdikgewogICAgICAgIHRoaXMucmVtb3ZlSW5mby50eXBlID0gMDsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgcmVzZXRDb25maWcoKSB7CiAgICAgIGNvbnN0IHR5cGUgPSB0aGlzLnJlbW92ZUluZm8udHlwZTsKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG6YeN572u5omA6YCJ5pWw5o2u77yM5piv5ZCm57un57utPycsICfmj5DnpLonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KQogICAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICAgIHN3aXRjaCAodHlwZSkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgY2xlYXJEYXRhKCk7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRDbGVhclN0b3JlJyk7CiAgICAgICAgICAgICAgZGF0YWJhc2UuY2xlYXIoREJfU1RPUkVfTkFNRSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICByZW1vdmVEYXRhKGNvbmZpZ0ZpZWxkKTsKICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldENsZWFyQ29uZmlnJyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICByZW1vdmVEYXRhKGxpc3RGaWVsZCk7CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRDbGVhckxpc3QnKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGRhdGFiYXNlLmNsZWFyKERCX1NUT1JFX05BTUUpOwogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Q2xlYXJQaG90b3MnKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgIHJlbW92ZURhdGEocmVzdWx0RmllbGQpOwogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0Q2xlYXJSZXN1bHQnKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmNsb3NlUmVzICYmIHRoaXMuY2xvc2VSZXMoKTsKCiAgICAgICAgICB0aGlzLnNob3dSZW1vdmVvcHRpb25zID0gZmFsc2U7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBtZXNzYWdlOiAn6YeN572u5oiQ5YqfIScKICAgICAgICAgIH0pOwoKICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgICAgdGhpcy4kZW1pdCgncmVzZXRDb25maWcnKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKCgpID0+IHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtognCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0sCiAgICBvblN1Ym1pdCgpIHsKICAgICAgaWYgKCF0aGlzLmZvcm0uY2F0ZWdvcnkpIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6K+36YCJ5oup5pys5qyh5oq95Y+W55qE5aWW6aG5Jyk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMucmVtYWluIDw9IDApIHsKICAgICAgICByZXR1cm4gdGhpcy4kbWVzc2FnZS5lcnJvcign6K+l5aWW6aG55Ymp5L2Z5Lq65pWw5LiN6LazJyk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuZm9ybS5tb2RlID09PSA5OSkgewogICAgICAgIGlmICh0aGlzLmZvcm0ucXR5IDw9IDApIHsKICAgICAgICAgIHJldHVybiB0aGlzLiRtZXNzYWdlLmVycm9yKCflv4XpobvovpPlhaXmnKzmrKHmir3lj5bkurrmlbAnKTsKICAgICAgICB9CiAgICAgICAgaWYgKHRoaXMuZm9ybS5xdHkgPiB0aGlzLnJlbWFpbikgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+acrOasoeaKveWlluS6uuaVsOW3sui2hei/h+acrOWllumhueeahOWJqeS9meS6uuaVsCcpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodGhpcy5mb3JtLm1vZGUgPT09IDEgfHwgdGhpcy5mb3JtLm1vZGUgPT09IDUpIHsKICAgICAgICBpZiAodGhpcy5mb3JtLm1vZGUgPiB0aGlzLnJlbWFpbikgewogICAgICAgICAgcmV0dXJuIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+acrOasoeaKveWlluS6uuaVsOW3sui2hei/h+acrOWllumhueeahOWJqeS9meS6uuaVsCcpOwogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLnNob3dTZXR3YXQgPSBmYWxzZTsKICAgICAgdGhpcy4kZW1pdCgKICAgICAgICAndG9nZ2xlJywKICAgICAgICBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmZvcm0sIHsgcmVtYWluOiB0aGlzLnJlbWFpbiB9KQogICAgICApOwogICAgfSwKICAgIHN0YXJ0SGFuZGxlcigpIHsKICAgICAgdGhpcy4kZW1pdCgndG9nZ2xlJyk7CiAgICAgIGlmICghdGhpcy5ydW5uaW5nKSB7CiAgICAgICAgdGhpcy5zaG93U2V0d2F0ID0gdHJ1ZTsKICAgICAgfQogICAgfSwKICAgIHRyYW5zZm9ybUxpc3QoKSB7CiAgICAgIGNvbnN0IHsgbGlzdFN0ciB9ID0gdGhpczsKICAgICAgaWYgKCFsaXN0U3RyKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign5rKh5pyJ5pWw5o2uJyk7CiAgICAgIH0KICAgICAgY29uc3QgbGlzdCA9IFtdOwogICAgICBjb25zdCByb3dzID0gbGlzdFN0ci5zcGxpdCgnXG4nKTsKICAgICAgaWYgKHJvd3MgJiYgcm93cy5sZW5ndGggPiAwKSB7CiAgICAgICAgcm93cy5mb3JFYWNoKGl0ZW0gPT4gewogICAgICAgICAgY29uc3Qgcm93TGlzdCA9IGl0ZW0uc3BsaXQoL1x0fFxzLyk7CiAgICAgICAgICBpZiAocm93TGlzdC5sZW5ndGggPj0gMikgewogICAgICAgICAgICBjb25zdCBrZXkgPSBOdW1iZXIocm93TGlzdFswXS50cmltKCkpOwogICAgICAgICAgICBjb25zdCBuYW1lID0gcm93TGlzdFsxXS50cmltKCk7CiAgICAgICAgICAgIGtleSAmJgogICAgICAgICAgICAgIGxpc3QucHVzaCh7CiAgICAgICAgICAgICAgICBrZXksCiAgICAgICAgICAgICAgICBuYW1lCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRMaXN0JywgbGlzdCk7CgogICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICBtZXNzYWdlOiAn5L+d5a2Y5oiQ5YqfJywKICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgfSk7CiAgICAgIHRoaXMuc2hvd0ltcG9ydCA9IGZhbHNlOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kZW1pdCgncmVzZXRDb25maWcnKTsKICAgICAgfSk7CiAgICB9CiAgfQp9Owo="},{"version":3,"sources":["Tool.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Tool.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div id=\"tool\">\n    <el-button @click=\"startHandler\" type=\"primary\" size=\"mini\">{{\n      running ? '停止' : '开始'\n    }}</el-button>\n    <el-button size=\"mini\" @click=\"showRemoveoptions = true\">\n      重置\n    </el-button>\n    <el-button size=\"mini\" @click=\"showImport = true\">\n      导入名单\n    </el-button>\n    <el-button size=\"mini\" @click=\"showImportphoto = true\">\n      导入照片\n    </el-button>\n    <el-dialog\n      :append-to-body=\"true\"\n      :visible.sync=\"showSetwat\"\n      class=\"setwat-dialog\"\n      width=\"400px\"\n    >\n      <el-form ref=\"form\" :model=\"form\" label-width=\"80px\" size=\"mini\">\n        <el-form-item label=\"抽取奖项\">\n          <el-select v-model=\"form.category\" placeholder=\"请选取本次抽取的奖项\">\n            <el-option\n              :label=\"item.label\"\n              :value=\"item.value\"\n              v-for=\"(item, index) in categorys\"\n              :key=\"index\"\n            ></el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\" \" v-if=\"form.category\">\n          <span>\n            共&nbsp;\n            <span class=\"colorred\">{{ config[form.category] }}</span>\n            &nbsp;名\n          </span>\n          <span :style=\"{ marginLeft: '20px' }\">\n            剩余&nbsp;\n            <span class=\"colorred\">{{ remain }}</span>\n            &nbsp;名\n          </span>\n        </el-form-item>\n\n        <el-form-item label=\"抽取方式\">\n          <el-select v-model=\"form.mode\" placeholder=\"请选取本次抽取方式\">\n            <el-option label=\"抽1人\" :value=\"1\"></el-option>\n            <el-option label=\"抽5人\" :value=\"5\"></el-option>\n            <el-option label=\"一次抽取完\" :value=\"0\"></el-option>\n            <el-option label=\"自定义\" :value=\"99\"></el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"抽取人数\" v-if=\"form.mode === 99\">\n          <el-input\n            v-model=\"form.qty\"\n            type=\"number\"\n            :clearable=\"true\"\n            :min=\"1\"\n            :max=\"remain ? remain : 100\"\n            :step=\"1\"\n          ></el-input>\n        </el-form-item>\n\n        <el-form-item label=\"全员参与\">\n          <el-switch v-model=\"form.allin\"></el-switch>\n          <span :style=\"{ fontSize: '12px' }\">\n            (开启后将在全体成员[无论有无中奖]中抽奖)\n          </span>\n        </el-form-item>\n\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"onSubmit\">立即抽奖</el-button>\n          <el-button @click=\"showSetwat = false\">取消</el-button>\n        </el-form-item>\n      </el-form>\n    </el-dialog>\n\n    <el-dialog\n      :append-to-body=\"true\"\n      :visible.sync=\"showImport\"\n      class=\"import-dialog\"\n      width=\"400px\"\n    >\n      <el-input\n        type=\"textarea\"\n        :rows=\"10\"\n        placeholder=\"请输入对应的号码和名单(可直接从excel复制)，格式(号码 名字)，导入的名单将代替号码显示在抽奖中。如：\n1 张三\n2 李四\n3 王五\n\t\t\t\t\"\n        v-model=\"listStr\"\n      ></el-input>\n      <div class=\"footer\">\n        <el-button size=\"mini\" type=\"primary\" @click=\"transformList\"\n          >确定</el-button\n        >\n        <el-button size=\"mini\" @click=\"showImport = false\">取消</el-button>\n      </div>\n    </el-dialog>\n    <Importphoto\n      :visible.sync=\"showImportphoto\"\n      @getPhoto=\"$emit('getPhoto')\"\n    ></Importphoto>\n\n    <el-dialog\n      :visible.sync=\"showRemoveoptions\"\n      width=\"300px\"\n      class=\"c-removeoptions\"\n      :append-to-body=\"true\"\n    >\n      <el-form ref=\"form\" :model=\"removeInfo\" label-width=\"80px\" size=\"mini\">\n        <el-form-item label=\"重置选项\">\n          <el-radio-group v-model=\"removeInfo.type\">\n            <el-radio border :label=\"0\">重置全部数据</el-radio>\n            <el-radio border :label=\"1\">重置抽奖配置</el-radio>\n            <el-radio border :label=\"2\">重置名单</el-radio>\n            <el-radio border :label=\"3\">重置照片</el-radio>\n            <el-radio border :label=\"4\">重置抽奖结果</el-radio>\n          </el-radio-group>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"resetConfig\">确定重置</el-button>\n          <el-button @click=\"showRemoveoptions = false\">取消</el-button>\n        </el-form-item>\n      </el-form>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport {\n  clearData,\n  removeData,\n  configField,\n  listField,\n  resultField,\n  conversionCategoryName\n} from '@/helper/index';\nimport Importphoto from './Importphoto';\nimport { database, DB_STORE_NAME } from '@/helper/db';\n\nexport default {\n  props: {\n    running: Boolean,\n    closeRes: Function\n  },\n  computed: {\n    config: {\n      get() {\n        return this.$store.state.config;\n      }\n    },\n    remain() {\n      return (\n        this.config[this.form.category] -\n        (this.result[this.form.category]\n          ? this.result[this.form.category].length\n          : 0)\n      );\n    },\n    result() {\n      return this.$store.state.result;\n    },\n    categorys() {\n      const options = [];\n      for (const key in this.config) {\n        if (this.config.hasOwnProperty(key)) {\n          const item = this.config[key];\n          if (item > 0) {\n            let name = conversionCategoryName(key);\n            name &&\n              options.push({\n                label: name,\n                value: key\n              });\n          }\n        }\n      }\n      return options;\n    }\n  },\n  components: { Importphoto },\n  data() {\n    return {\n      showSetwat: false,\n      showImport: false,\n      showImportphoto: false,\n      showRemoveoptions: false,\n      removeInfo: { type: 0 },\n      form: {\n        category: '',\n        mode: 1,\n        qty: 1,\n        allin: false\n      },\n      listStr: ''\n    };\n  },\n  watch: {\n    showRemoveoptions(v) {\n      if (!v) {\n        this.removeInfo.type = 0;\n      }\n    }\n  },\n  methods: {\n    resetConfig() {\n      const type = this.removeInfo.type;\n      this.$confirm('此操作将重置所选数据，是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      })\n        .then(() => {\n          switch (type) {\n            case 0:\n              clearData();\n              this.$store.commit('setClearStore');\n              database.clear(DB_STORE_NAME);\n              break;\n            case 1:\n              removeData(configField);\n              this.$store.commit('setClearConfig');\n              break;\n            case 2:\n              removeData(listField);\n              this.$store.commit('setClearList');\n              break;\n            case 3:\n              database.clear(DB_STORE_NAME);\n              this.$store.commit('setClearPhotos');\n              break;\n            case 4:\n              removeData(resultField);\n              this.$store.commit('setClearResult');\n              break;\n            default:\n              break;\n          }\n\n          this.closeRes && this.closeRes();\n\n          this.showRemoveoptions = false;\n          this.$message({\n            type: 'success',\n            message: '重置成功!'\n          });\n\n          this.$nextTick(() => {\n            this.$emit('resetConfig');\n          });\n        })\n        .catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消'\n          });\n        });\n    },\n    onSubmit() {\n      if (!this.form.category) {\n        return this.$message.error('请选择本次抽取的奖项');\n      }\n      if (this.remain <= 0) {\n        return this.$message.error('该奖项剩余人数不足');\n      }\n      if (this.form.mode === 99) {\n        if (this.form.qty <= 0) {\n          return this.$message.error('必须输入本次抽取人数');\n        }\n        if (this.form.qty > this.remain) {\n          return this.$message.error('本次抽奖人数已超过本奖项的剩余人数');\n        }\n      }\n      if (this.form.mode === 1 || this.form.mode === 5) {\n        if (this.form.mode > this.remain) {\n          return this.$message.error('本次抽奖人数已超过本奖项的剩余人数');\n        }\n      }\n      this.showSetwat = false;\n      this.$emit(\n        'toggle',\n        Object.assign({}, this.form, { remain: this.remain })\n      );\n    },\n    startHandler() {\n      this.$emit('toggle');\n      if (!this.running) {\n        this.showSetwat = true;\n      }\n    },\n    transformList() {\n      const { listStr } = this;\n      if (!listStr) {\n        this.$message.error('没有数据');\n      }\n      const list = [];\n      const rows = listStr.split('\\n');\n      if (rows && rows.length > 0) {\n        rows.forEach(item => {\n          const rowList = item.split(/\\t|\\s/);\n          if (rowList.length >= 2) {\n            const key = Number(rowList[0].trim());\n            const name = rowList[1].trim();\n            key &&\n              list.push({\n                key,\n                name\n              });\n          }\n        });\n      }\n      this.$store.commit('setList', list);\n\n      this.$message({\n        message: '保存成功',\n        type: 'success'\n      });\n      this.showImport = false;\n      this.$nextTick(() => {\n        this.$emit('resetConfig');\n      });\n    }\n  }\n};\n</script>\n<style lang=\"scss\">\n#tool {\n  position: fixed;\n  width: 60px;\n  top: 50%;\n  right: 20px;\n  transform: translateY(-50%);\n  text-align: center;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  .el-button + .el-button {\n    margin-top: 20px;\n    margin-left: 0px;\n  }\n}\n.setwat-dialog {\n  .colorred {\n    color: red;\n    font-weight: bold;\n  }\n}\n.import-dialog {\n  .footer {\n    height: 50px;\n    line-height: 50px;\n    text-align: center;\n  }\n}\n.c-removeoptions {\n  .el-dialog {\n    height: 290px;\n  }\n  .el-radio.is-bordered + .el-radio.is-bordered {\n    margin-left: 0px;\n  }\n  .el-radio.is-bordered {\n    margin-bottom: 10px;\n  }\n}\n</style>\n"]}]}